éœ€è¦æ‰‹åŠ¨ä¿®æ”¹2å¤„ï¼š

========== ä¿®å¤1: action_dim (ç¬¬145è¡Œ) ==========
æ‰¾åˆ°ç¬¬145è¡Œï¼š
    print(f"  - åŠ¨ä½œç»´åº¦: {dataset.meta.action_dim}")

æ”¹ä¸º3è¡Œï¼š
    sample = dataset[0]
    action_dim = sample['action'].shape[0] if 'action' in sample else 6
    print(f"  - åŠ¨ä½œç»´åº¦: {action_dim}")

========== ä¿®å¤2: å›¾åƒkeyé‡æ˜ å°„ (ç¬¬151è¡Œåæ·»åŠ ) ==========
åœ¨ç¬¬151è¡Œ (print(f"\nğŸ”„ åˆ›å»ºæ•°æ®åŠ è½½å™¨..."))ä¹‹åæ·»åŠ ï¼š

    # å®šä¹‰collateå‡½æ•°æ¥é‡æ˜ å°„å›¾åƒkey
    def collate_fn(batch_list):
        from torch.utils.data.dataloader import default_collate
        batch = default_collate(batch_list)
        # é‡æ˜ å°„: top->camera1, wrist->camera2å’Œcamera3
        if "observation.images.top" in batch:
            batch["observation.images.camera1"] = batch.pop("observation.images.top")
        if "observation.images.wrist" in batch:
            batch["observation.images.camera2"] = batch["observation.images.wrist"]
            batch["observation.images.camera3"] = batch.pop("observation.images.wrist")
        return batch

ç„¶åä¿®æ”¹DataLoaderæ·»åŠ collate_fnå‚æ•°ï¼š
    dataloader = DataLoader(
        dataset,
        batch_size=config.batch_size,
        shuffle=True,
        num_workers=2,
        pin_memory=True,
        collate_fn=collate_fn,  # æ·»åŠ è¿™ä¸€è¡Œ
    )
